<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Edit Tamu | OCR</title>
        <link rel="icon" href="{{ url_for('static', filename='img/ocr.png') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='dataTables/dataTables.bootstrap5.css') }}">
    </head>
    <style>
        /* CSS untuk memusatkan teks dan mengatur ukuran font */
        #tableListTamu td, #tableListTamu th {
            text-align: center;
        }
        body {
            padding-top: 56px;
        }
    </style>
    <body>
        <!-- <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
            <div class="container-fluid">
                <div class="d-flex ms-auto">
                    <a href="{{ url_for('ocr') }}">
                        <img src="{{ url_for('static', filename='img/ocr.png') }}" alt="Your Image" class="img-fluid" style="height: 40px;">
                    </a>
                </div>
            </div>
        </nav> -->

        <!-- Content area -->
        <div class="container mt-2">
            <h3 class="mt-3 text-center">Input Keperluan Tamu</h3>
            {% if list_tamu %}
            <table id="tableListTamu" class="table table-hover">
                <thead>
                    <tr>
                        <th>Waktu Masuk</th>
                        <th>No Mobil</th>
                        <th>Status</th>
                        <th>PIC STT</th>
                        <th>Keperluan</th>
                        <th>Waktu Keluar</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in list_tamu %}
                    <tr>
                        <td>{{ row[0] }}</td>
                        <td>{{ row[1] }}</td>
                        <td>{{ row[2] }}</td>
                        <td>{{ row[3] if row[3] else '-' }}</td>
                        <td>{{ row[4] if row[4] else '-' }}</td>
                        <td>{{ row[5] if row[5] else '-' }}</td>
                        <td>
                            {% if not row[3] and not row[4] %}
                            <!-- Edit Button to trigger the modal -->
                            <button type="button" class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#editModal" onclick="populateModal('{{ row[1] }}', '{{ row[2] }}')">
                                Isi Keperluan
                            </button>
                            {% else %}
                            -
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p>Data tidak tersedia.</p>
            {% endif %}

            <!-- Edit Modal -->
            <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="editModalLabel">Isi Keperluan Tamu</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form id="editForm" action="/ocr/update_tamu" method="POST">
                                <div class="mb-2">
                                    <label for="noMobil" class="form-label">No Mobil</label>
                                    <input type="text" class="form-control" id="noMobil" name="noMobil" readonly>
                                </div>
                                <div class="mb-2">
                                    <label for="picSTT" class="form-label">PIC STT</label>
                                    <input type="text" class="form-control" id="picSTT" name="picSTT" required>
                                    <small id="picSTTHelp" class="form-text text-muted">Diisi Nama PIC STT atau Penerima Tamu.</small>
                                </div>
                                <div class="mb-2">
                                    <label for="inputTujuan" class="form-label">Keperluan</label>
                                    <select class="form-select" id="keperluan" name="keperluan" required>
                                        <option selected disabled value="">Pilih Keperluan</option>
                                        {% for item in list_keperluan %}
                                            <option value="{{ item }}">{{ item }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-primary">Simpan Data</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- JavaScript files -->
        <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
        <script src="{{ url_for('static', filename='js/jquery-3.7.1.js') }}"></script>
        <script src="{{ url_for('static', filename='js/popper.min.js') }}"></script>
        <script src="{{ url_for('static', filename='dataTables/dataTables.js') }}"></script>
        <script src="{{ url_for('static', filename='dataTables/dataTables.bootstrap5.js') }}"></script>
        <script>
            $(document).ready(function() {
                $('#tableListTamu').DataTable({
                    ordering: false, // Disable sorting
                    paging: true,
                    pageLength: 10,
                    lengthMenu: [ 10, 50, 100 ],
                    language: {
                        search: 'Cari Data',
                        lengthMenu: '_MENU_  Data Per Halaman',
                        info: 'Menampilkan _START_ hingga _END_ dari total _TOTAL_ data',
                        infoEmpty: 'Menampilkan 0 hingga 0 dari 0 data',
                    }
                });
            });

            function populateModal(noMobil, status) {
                // Populate the modal fields with current data
                document.getElementById('noMobil').value = noMobil;
                // You can fetch the other data if needed or keep them editable
                document.getElementById('picSTT').value = '';
                document.getElementById('keperluan').value = '';
            }
        </script>
    </body>
</html>
