{% extends "base.html" %}

{% block title %}
    OCR
{% endblock %}

{% block content %}
<style>
    #foldersTable {
        font-size: 80%;
    }
    #foldersTable td, #foldersTable th {
        text-align: center;
    }
    body {
        padding-top: 56px;
    }
</style>
<div class="container mt-2">
    <h3 class="text-center">OCR</h3>
    <div class="card">
        <div class="card-body">
            <form id="actionForm" action="/ocr" method="post" enctype="multipart/form-data">
                <div class="mb-3 text-center">
                    <label for="image" class="form-label">Pilih Foto yang Akan Diproses</label>
                    <input class="form-control" type="file" id="image" name="image" capture="environment" accept="image/*;capture=environment" onchange="previewImage(event)">
                </div>
                <div class="mb-3">
                    <img id="imagePreview" class="mx-auto d-block img-thumbnail" src="#" alt="Image preview" style="display:none !important; max-width: 100%; height: auto;">
                </div>
                <div class="mb-3">
                    <div class="row">
                        <div class="col-6">
                            <button type="button" id="masukButton" class="btn btn-success btn-lg w-100" onclick="submitForm('Masuk')" disabled>Masuk</button>
                        </div>
                        <div class="col-6">
                            <button type="button" id="keluarButton" class="btn btn-danger btn-lg w-100" onclick="submitForm('Keluar')" disabled>Keluar</button>
                        </div>
                    </div>
                </div>
            </form>

            <!-- ADD Loading -->
            <button class="btn btn-secondary btn-lg w-100 mt-2" id="loadingButton" style="display: none;" disabled>
                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                Loading...
            </button>
        </div>
    </div>

    {% if message %}
        <div class="alert alert-{{ message_type }} text-center mt-1" role="alert">
            {{ message }}
        </div>
    {% endif %}

    {% if label %}
        <div class="text-center">
            <h6>Label: {{ label }}</h6>
        </div>
    {% endif %}

    {% if data %}
        <div class="text-center mt-2">
            <!-- <h5>Captured Image with Labels</h5> -->
            <img src="{{ data }}" alt="Captured Image" class="img-thumbnail mx-auto d-block" style="max-width: 700-x;">
        </div>
    {% endif %}

    <hr class="bg-danger border-3 border-top border-dark" />
    <h5 class="mt-3 text-center">Data Foto Diproses</h5>
    <table id="foldersTable" class="table table-hover">
        <thead>
            <tr>
                <th>No</th>
                <th>Plat Nomor</th>
                <th>Kategori</th>
                <th>Waktu</th>
            </tr>
        </thead>
        <tbody>
            {% for row in csv_data %}
            <tr>
                <td>{{ row[0] }}</td>
                <td>{{ row[1] }}</td>
                <td>{{ row[2] }}</td>
                <td>{{ row[3] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>


{% endblock %}